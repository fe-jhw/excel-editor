# 엑셀 에디터 만들기

## TODO 
- 편집박스 - 함수, 필터
  - 함수: 누르면 4개 중 선택 (합계, 평균, 최대값, 최소값) - 어려워서 기능은 좀 나중에...
    - 하나 선택하면 선택된 셀(1개) 에 함수값이 나타남
    - 그다음 나머지 영역 선택하도록?
- 파일 열기, 시트 바꾸기 기능 (recoil 사용하자)
- 셀 행열 길이 고정후 경계 드래그해서 높이, 길이 늘일수 있게 하기 (진행중)
  - row, col header에 (칸마다)Divider drag 가능한거 추가, 걔 drag 이벤트로 width, height 조정 가능하게 하기
  - 이슈: 현재 sheet 전체에 drag event 막아놈, 풀고 table에만 주면 header쪽 드래그는 잘 작동하지만 그 후에 드래그후 셀쪽에서 isDrag가 true인채로 유지됨
- 성능 측정
- 테스트코드 작성

## 리팩토링 할 것들

- 뒤로가기, 앞으로가기 구현

  - 셀 value 변경시 글자 1개 변경시마다 담김 - Debounce 적용시에 함수박스의 input과 선택상자의 input 동기화가 잘 안됨(상태 변경도 debounce를 걸 경우, -> history넣는것만 debounce를 걸어야함)

  - 전체적으로 리팩토링 필요~ 너무 접근점이 많음
- Toolbox 매번 리렌더링됨..
- history 동작 전체적으로 점검후 리팩터링
- 키보드입력 (ctrl z, ctrl c 등등) 
  - 방향키로 cell 이동 (방향키) - 안보이는곳으로 이동시 scroll 기능 필요
- FRAMER 적용 - 선택변경시 부드럽게 선택상자 이동시키기 (드래그시 이상하게 동작해서 뺏음)
  - 셀 삽입, 삭제시에 
    - 셀 첫생성시 고유 ID 주기 (O)
    - 애니메이션 주기 넘어렵 i,j 바뀌어서 행,열추가시에 그 밑에 모든 row나 옆에 모든애들이 재렌더링 -> 전체 애니메이션 들어감
    - 그리고 기본으로 흰바탕에 테두리인데 얘네들은 애니메이션 줘도 별 티가 안남

## 버그

- border 겹치는데 색깔 다른 경우 좌측위가 우선권가져서 border가 이상하게 나옴
- 셀 폰트 크기 일정 이상이면 height 늘어남

- cell 세로정렬 제대로 안보임

- 내용지우기시 굵기, Italic 등은 안지워짐

- 스크롤 양끝에 있을시 자동으로 행,열 추가 얘네도 histories에 쌓임

- 복붙시에 history 동작 이상함